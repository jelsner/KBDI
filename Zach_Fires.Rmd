---
title: "Zach_Fires"
author: "Zach Law"
date: "3/15/2021"
output: html_document
---

This file will be used to further analyze fire data bounded by the Apalachicola National Forest.


##Importing/creating boundaries of Apalachicola National Forest

Link to National Forest Boundary File: https://data.fs.usda.gov/geodata/edw/datasets.php?xmlKeyword=National+Forest+System+Land+Units

*Note: This link provides boundaries for every national forest boundary in the U.S.
Because we only want the boundary for the Apalachicola National Forest, the file was edited in esri arcpro and a shapefile containing only the Apalachicola National Forest boundaries was exported for use here.

```{r}
library(tidyverse)
library(sf)

anfbounds <- read_sf(dsn = "forest boundaries",
                     layer = "ANFboundaries") %>%
  st_transform(crs = 3086)
  
```



Alternative method for importing forest shapefile using only R.

```{r}
library(tidyverse)
library(sf)

if(!"S_USA.NFSLandUnit" %in% list.files()){
  download.file("https://data.fs.usda.gov/geodata/edw/edw_resources/shp/S_USA.NFSLandUnit.zip",
                "S_USA.NFSLandUnit.zip")
unzip("S_USA.NFSLandUnit.zip")
}

NF_Bounds.sf <- st_read(dsn = "s_USA.NFSLandUnit.shp") %>%
  st_transform(crs = 3086)
```

Filter shapefile for just Apalachicola National Forest. Table won't load and we don't know how to isolate the apalachicola forest boundary.


Window for all forest boundaries
```{r}
library(spatstat)
library(maptools)

nf.win <- NF_Bounds.sf %>%
  as_Spatial() %>%
  as.owin()

plot(nf.win)
```




Create window for apalacicola national forest boundary

```{r}
library(spatstat)
library(maptools)

anf.win <- anfbounds %>%
  as_Spatial() %>%
  as.owin()

plot(anf.win)
```

##Importing Fire Data

```{r}
if(!"FL_Fires" %in% list.files()){
download.file("http://myweb.fsu.edu/jelsner/temp/data/FL_Fires.zip",
"FL_Fires.zip")
unzip("FL_Fires.zip")
}
FL_Fires.sf <- st_read(dsn = "FL_Fires") %>%
st_transform(crs = 3086)
```

Create fire data into ppp object
```{r}
fires.ppp <- FL_Fires.sf %>%
  as_Spatial() %>%
  as.ppp() %>%
  unmark()
```


Filter for fires only in the Apalachicola National Forest Boundary
```{r}
anf_fires.ppp <- fires.ppp[anf.win]

plot(anf_fires)
```


Filter FL_Fires simple feature dataframe for only fires bounded by anf
```{r}
anf_fires.sf <- st_join(FL_Fires.sf, anfbounds, join = st_within) %>%
  filter(NFSLANDU_2 == 'Apalachicola National Forest')
```


```{r}
library(lubridate)
library(ggplot2)

anf_fires.sf %>% 
  ggplot(mapping = aes(x = month(DISCOVERY_))) +
    geom_bar() +
    facet_wrap(~ FIRE_Y)
```

Running this code we see that fires are most active during May and June and least active during December
```{r}
anf_fires.sf %>% 
  ggplot(mapping = aes(x = month(DISCOVERY_))) +
    geom_bar()
```

```{r}
FL_Fires.sf %>%
  filter(month(DISCOVERY_) == '05') %>%
  as_Spatial() %>%
  as.ppp() %>%
  unmark()
  
#FL_Fires.sf[anf.win]   
#plot(FL_Fires.sf)
```






